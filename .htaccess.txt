# Activation de la réécriture d'URL
RewriteEngine On

# Redirection vers HTTPS
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirection vers une URL avec www (décommente si besoin)
# RewriteCond %{HTTP_HOST} !^www\. [NC]
# RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Suppression du trailing slash sauf pour les dossiers
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [R=301,L]

# Forcer l'encodage UTF-8
AddDefaultCharset UTF-8

# Compression Gzip pour améliorer la vitesse de chargement
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Cache navigateur pour optimiser les performances
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType application/x-shockwave-flash "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 year"
    ExpiresDefault "access plus 2 days"
</IfModule>

# Protection contre le hotlinking des images
<IfModule mod_rewrite.c>
    RewriteCond %{HTTP_REFERER} !^$
    RewriteCond %{HTTP_REFERER} !^https://(www\.)?ton-domaine\.com/ [NC]
    RewriteRule \.(jpg|jpeg|png|gif)$ - [F]
</IfModule>

# Protection des fichiers sensibles
<FilesMatch "(^\.htaccess|\.htpasswd|config\.php|php.ini|php5.ini|install\.php|wp-config\.php|xmlrpc\.php)">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Personnalisation de la page d'erreur 404
ErrorDocument 404 /404.html
Redirect 301 /page-dupliquee https://www.fleurs-story.fr


